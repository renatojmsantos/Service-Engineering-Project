{"ast":null,"code":"var _jsxFileName = \"/Users/renatosantos/Dropbox/Aplicativos/NONIO-Inforestudante/Licenciatura em Engenharia Informa\\u0301tica/2019 2020/2.\\xBA Semestre/Engenharia de Servic\\u0327os/Service-Engineering-Project/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport AWS from 'aws-sdk';\nimport SearchLocation from './SearchLocation';\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128\n});\nvar bucketName = \"proj-es-s3/Voice\";\nvar bucketRegion = \"us-east-1\";\nvar IdentityPoolId = \"us-east-1:4797cc31-91b9-4466-8732-8e4707b5cfbc\";\nAWS.config.update({\n  region: bucketRegion,\n  credentials: new AWS.CognitoIdentityCredentials({\n    IdentityPoolId: IdentityPoolId\n  })\n});\nvar s3 = new AWS.S3({\n  apiVersion: \"2006-03-01\",\n  params: {\n    Bucket: bucketName\n  }\n});\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.start = () => {\n      if (this.state.isBlocked) {\n        console.log('Permission Denied');\n      } else {\n        Mp3Recorder.start().then(() => {\n          this.setState({\n            isRecording: true\n          });\n        }).catch(e => console.error(e));\n      }\n    };\n\n    this.stop = () => {\n      Mp3Recorder.stop().getMp3().then(([buffer, blob]) => {\n        const blobURL = URL.createObjectURL(blob);\n        this.setState({\n          blobURL,\n          isRecording: false\n        });\n        this.addAudio(blob);\n      }).catch(e => console.log(e));\n    };\n\n    this.addAudio = audio => {\n      console.log(audio);\n      var fileName = \"audio.mp3\";\n\n      if (!audio.size) {\n        return alert(\"No File to upload !!\");\n      }\n\n      var upload = new AWS.S3.ManagedUpload({\n        params: {\n          Bucket: bucketName,\n          Key: fileName,\n          Body: audio\n        }\n      });\n      var promise = upload.promise();\n      promise.then(function (data) {\n        alert(\"Audio inserido na Storage\");\n      }, function (err) {\n        return alert(\"ERROR: \", err.message);\n      });\n    };\n\n    this.state = {\n      isRecording: false,\n      blobURL: '',\n      isBlocked: false\n    };\n  }\n\n  componentDidMount() {\n    navigator.getUserMedia({\n      audio: true\n    }, () => {\n      console.log('Permission Granted');\n      this.setState({\n        isBlocked: false\n      });\n    }, () => {\n      console.log('Permission Denied');\n      this.setState({\n        isBlocked: true\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      className: \"App-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.start,\n      disabled: this.state.isRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }\n    }, \"Record\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.stop,\n      disabled: !this.state.isRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }, \"Stop\"), /*#__PURE__*/React.createElement(\"audio\", {\n      src: this.state.blobURL,\n      controls: \"controls\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.props.getLocation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/renatosantos/Dropbox/Aplicativos/NONIO-Inforestudante/Licenciatura em Engenharia Informática/2019 2020/2.º Semestre/Engenharia de Serviços/Service-Engineering-Project/src/App.js"],"names":["React","MicRecorder","AWS","SearchLocation","Mp3Recorder","bitRate","bucketName","bucketRegion","IdentityPoolId","config","update","region","credentials","CognitoIdentityCredentials","s3","S3","apiVersion","params","Bucket","App","Component","constructor","props","start","state","isBlocked","console","log","then","setState","isRecording","catch","e","error","stop","getMp3","buffer","blob","blobURL","URL","createObjectURL","addAudio","audio","fileName","size","alert","upload","ManagedUpload","Key","Body","promise","data","err","message","componentDidMount","navigator","getUserMedia","render","getLocation"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport AWS from 'aws-sdk';\nimport SearchLocation from './SearchLocation';\n\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\n\nvar bucketName = \"proj-es-s3/Voice\";\nvar bucketRegion = \"us-east-1\";\nvar IdentityPoolId = \"us-east-1:4797cc31-91b9-4466-8732-8e4707b5cfbc\";\n\nAWS.config.update({\n    region: bucketRegion,\n    credentials: new AWS.CognitoIdentityCredentials({\n      IdentityPoolId: IdentityPoolId\n  })\n});\n\n\nvar s3 = new AWS.S3({\n  apiVersion: \"2006-03-01\",\n  params: { Bucket: bucketName }\n});\n\n\nclass App extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      isRecording: false,\n      blobURL: '',\n      isBlocked: false,\n    };\n  }\n\n  start = () => {\n    if (this.state.isBlocked) {\n      console.log('Permission Denied');\n    } else {\n      Mp3Recorder\n        .start()\n        .then(() => {\n          this.setState({ isRecording: true });\n        }).catch((e) => console.error(e));\n    }\n  };\n\n  stop = () => {\n    Mp3Recorder\n      .stop()\n      .getMp3()\n      .then(([buffer, blob]) => {\n        const blobURL = URL.createObjectURL(blob)\n        this.setState({ blobURL, isRecording: false });\n\n        this.addAudio(blob)\n      }).catch((e) => console.log(e));\n  };\n\n  componentDidMount() {\n    navigator.getUserMedia({ audio: true },\n      () => {\n        console.log('Permission Granted');\n        this.setState({ isBlocked: false });\n      },\n      () => {\n        console.log('Permission Denied');\n        this.setState({ isBlocked: true })\n      },\n    );\n  }\n\n  addAudio = (audio) => {\n    console.log(audio)\n    var fileName = \"audio.mp3\";\n    if(!audio.size) {\n      return alert(\"No File to upload !!\");\n    }\n    \n    var upload = new AWS.S3.ManagedUpload({\n      params: {\n        Bucket: bucketName,\n        Key: fileName,\n        Body: audio\n      }  \n    });\n\n    var promise = upload.promise();\n\n    promise.then(\n      function(data) {\n        alert(\"Audio inserido na Storage\");\n      },\n      function(err) {\n        return alert(\"ERROR: \", err.message);\n      }\n    )\n\n  }\n\n  render(){\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <button onClick={this.start} disabled={this.state.isRecording}>Record</button>\n          <button onClick={this.stop} disabled={!this.state.isRecording}>Stop</button>\n          <audio src={this.state.blobURL} controls=\"controls\" />\n          <button onClick={this.props.getLocation}/>\n        </header>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}