{"ast":null,"code":"var _jsxFileName = \"/Users/renatosantos/Dropbox/Aplicativos/NONIO-Inforestudante/Licenciatura em Engenharia Informa\\u0301tica/2019 2020/2.\\xBA Semestre/Engenharia de Servic\\u0327os/Service-Engineering-Project/src/App.js\";\nimport React, { Component } from \"react\";\nimport './App.css';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport AWS from 'aws-sdk';\nimport SearchLocation from './SearchLocation';\nimport ReactDom from 'react-dom';\nimport { Redirect } from 'react-router-dom';\nimport AddressItem from './AddressItem';\nimport AddressForm from './AddressForm';\nimport TranscribeFetch from './getTranscribeStatus';\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128\n});\n\nconst sleep = milliseconds => {\n  return new Promise(resolve => setTimeout(resolve, milliseconds));\n};\n\nvar bucketName = \"proj-es-s3/Voice\";\nvar bucketRegion = \"us-east-1\";\nvar IdentityPoolId = \"us-east-1:4797cc31-91b9-4466-8732-8e4707b5cfbc\";\nAWS.config.update({\n  region: bucketRegion,\n  credentials: new AWS.CognitoIdentityCredentials({\n    IdentityPoolId: IdentityPoolId\n  })\n});\nvar s3 = new AWS.S3({\n  apiVersion: \"2006-03-01\",\n  params: {\n    Bucket: bucketName\n  }\n});\n\nfunction SearchLocationPage(props) {\n  if (!props.pesq) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AddressForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }\n  }));\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.start = () => {\n      if (this.state.isBlocked) {\n        console.log('Permission Denied');\n      } else {\n        Mp3Recorder.start().then(() => {\n          this.setState({\n            isRecording: true\n          });\n        }).catch(e => console.error(e));\n      }\n    };\n\n    this.stop = () => {\n      Mp3Recorder.stop().getMp3().then(([buffer, blob]) => {\n        const blobURL = URL.createObjectURL(blob);\n        this.setState({\n          blobURL,\n          isRecording: false\n        });\n        this.addAudio(blob);\n      }).catch(e => console.log(e));\n    };\n\n    this.addAudio = audio => {\n      console.log(audio);\n      var fileName = \"audio.mp3\";\n\n      if (!audio.size) {\n        return alert(\"No File to upload!\");\n      }\n\n      var upload = new AWS.S3.ManagedUpload({\n        params: {\n          Bucket: bucketName,\n          Key: fileName,\n          Body: audio\n        }\n      });\n      var promise = upload.promise();\n      promise.then(function (data) {\n        sleep(1000).then(() => {\n          alert(\"Audio inserido para Transcriçao\");\n          window.location.reload(false);\n        });\n      }, function (err) {\n        return alert(\"ERROR: \", err.message);\n      });\n    };\n\n    this.state = {\n      isRecording: false,\n      blobURL: '',\n      isBlocked: false\n    };\n    this.state = {\n      showSearchLocation: false\n    };\n    this.goSearch = this.goSearch.bind(this);\n  }\n\n  componentDidMount() {\n    navigator.getUserMedia({\n      audio: true\n    }, () => {\n      console.log('Permission Granted');\n      this.setState({\n        isBlocked: false\n      });\n    }, () => {\n      console.log('Permission Denied');\n      this.setState({\n        isBlocked: true\n      });\n    });\n  }\n\n  goSearch() {\n    console.log('submiittt');\n    this.setState(state => ({\n      showSearchLocation: true //showSearchLocation: !state.showSearchLocation\n\n    }));\n  }\n  /*\n  onSubmit = () => {\n    console.log(\"submit\");\n    //return <Redirect  to=\"/SearchLocation/\" /> \n    return this.setState({ Redirect :  \"/SearchLocation\"})\n  }\n   state = { Redirect: null };\n  */\n\n\n  render() {\n    //<audio src={this.state.blobURL} controls=\"controls\" />\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 7\n      }\n    }, this.props.callApi, /*#__PURE__*/React.createElement(\"header\", {\n      className: \"App-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.start,\n      disabled: this.state.isRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }\n    }, \"Record\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.stop,\n      disabled: !this.state.isRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }\n    }, \"Stop\"), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 11\n      }\n    }, \"Transcri\\xE7\\xE3o:\", /*#__PURE__*/React.createElement(TranscribeFetch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(SearchLocationPage, {\n      pesq: this.state.showSearchLocation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.goSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 11\n      }\n    }, \" \", this.state.showSearchLocation, \"Pesquisar endereco!\")));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/renatosantos/Dropbox/Aplicativos/NONIO-Inforestudante/Licenciatura em Engenharia Informática/2019 2020/2.º Semestre/Engenharia de Serviços/Service-Engineering-Project/src/App.js"],"names":["React","Component","MicRecorder","AWS","SearchLocation","ReactDom","Redirect","AddressItem","AddressForm","TranscribeFetch","Mp3Recorder","bitRate","sleep","milliseconds","Promise","resolve","setTimeout","bucketName","bucketRegion","IdentityPoolId","config","update","region","credentials","CognitoIdentityCredentials","s3","S3","apiVersion","params","Bucket","SearchLocationPage","props","pesq","App","constructor","start","state","isBlocked","console","log","then","setState","isRecording","catch","e","error","stop","getMp3","buffer","blob","blobURL","URL","createObjectURL","addAudio","audio","fileName","size","alert","upload","ManagedUpload","Key","Body","promise","data","window","location","reload","err","message","showSearchLocation","goSearch","bind","componentDidMount","navigator","getUserMedia","render","callApi"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport './App.css';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport AWS from 'aws-sdk';\nimport SearchLocation from './SearchLocation';\nimport ReactDom from 'react-dom';\nimport {Redirect} from 'react-router-dom';\nimport AddressItem from './AddressItem';\nimport AddressForm from './AddressForm';\nimport TranscribeFetch from './getTranscribeStatus';\n\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\nconst sleep = (milliseconds) => {\n  return new Promise(resolve => setTimeout(resolve, milliseconds))\n}\n\nvar bucketName = \"proj-es-s3/Voice\";\nvar bucketRegion = \"us-east-1\";\nvar IdentityPoolId = \"us-east-1:4797cc31-91b9-4466-8732-8e4707b5cfbc\";\n\nAWS.config.update({\n    region: bucketRegion,\n    credentials: new AWS.CognitoIdentityCredentials({\n      IdentityPoolId: IdentityPoolId\n  })\n});\n\nvar s3 = new AWS.S3({\n  apiVersion: \"2006-03-01\",\n  params: { Bucket: bucketName }\n});\n\nfunction SearchLocationPage(props) {\n  if (!props.pesq) {\n    return null;\n  }\n  return (\n    <div className=\"container\">\n      <AddressForm/>\n    </div>\n  );\n}\n\nclass App extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      isRecording: false,\n      blobURL: '',\n      isBlocked: false,\n    };\n    this.state = {showSearchLocation: false};\n    this.goSearch = this.goSearch.bind(this);\n  }\n\n  start = () => {\n    if (this.state.isBlocked) {\n      console.log('Permission Denied');\n    } else {\n      Mp3Recorder\n        .start()\n        .then(() => {\n          this.setState({ isRecording: true });\n        }).catch((e) => console.error(e));\n    }\n  };\n\n  stop = () => {\n    Mp3Recorder\n      .stop()\n      .getMp3()\n      .then(([buffer, blob]) => {\n        const blobURL = URL.createObjectURL(blob)\n        this.setState({ blobURL, isRecording: false });\n\n        this.addAudio(blob)\n      }).catch((e) => console.log(e));\n  };\n\n  componentDidMount() {\n    navigator.getUserMedia({ audio: true },\n      () => {\n        console.log('Permission Granted');\n        this.setState({ isBlocked: false });\n      },\n      () => {\n        console.log('Permission Denied');\n        this.setState({ isBlocked: true })\n      },\n    );\n  }\n\n  addAudio = (audio) => {\n    console.log(audio)\n    var fileName = \"audio.mp3\";\n    if(!audio.size) {\n      return alert(\"No File to upload!\");\n    }\n    \n    var upload = new AWS.S3.ManagedUpload({\n      params: {\n        Bucket: bucketName,\n        Key: fileName,\n        Body: audio\n      }  \n    });\n\n    var promise = upload.promise();\n\n    promise.then(\n      function(data) {\n        sleep(1000).then(() => {\n          alert(\"Audio inserido para Transcriçao\");\n          window.location.reload(false);  \n        })              \n      },\n      function(err) {\n        return alert(\"ERROR: \", err.message);\n      }\n    )\n  }\n\n  goSearch(){\n      console.log('submiittt');\n      this.setState(state => ({\n        showSearchLocation: true\n        //showSearchLocation: !state.showSearchLocation\n      }));\n  }\n\n  /*\n  onSubmit = () => {\n    console.log(\"submit\");\n    //return <Redirect  to=\"/SearchLocation/\" /> \n    return this.setState({ Redirect :  \"/SearchLocation\"})\n }\n\n  state = { Redirect: null };\n*/\n  render(){\n    //<audio src={this.state.blobURL} controls=\"controls\" />\n    \n    return (\n      <div className=\"App\">\n         {this.props.callApi}\n        <header className=\"App-header\">\n          <button onClick={this.start} disabled={this.state.isRecording}>Record</button>\n          <button onClick={this.stop} disabled={!this.state.isRecording}>Stop</button>\n          \n          <h3>\n            Transcrição:\n            <TranscribeFetch />\n          </h3>\n\n          <SearchLocationPage pesq = {this.state.showSearchLocation}/>\n          <button onClick={this.goSearch}> {this.state.showSearchLocation}Pesquisar endereco!</button>\n\n        </header>\n      </div>\n    );\n  }\n \n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}